# Milestone v1.0: Align with vibe-kanban API

**Status:** âœ… SHIPPED 2026-01-31 **Phases:** 1-4 **Total Plans:** 5

## Overview

This milestone fixed the broken follow-up command and aligned the CLI with the
current vibe-kanban backend API. The work progressed from critical bug fixes
(follow-up endpoint), through schema corrections (multi-repo support), type
alignment (API parity), and session command exposure.

## Phases

### Phase 1: Critical Fix

**Goal**: Users can send follow-up messages to running workspaces **Depends
on**: Nothing (first phase) **Requirements**: SESS-01, SESS-02, SESS-03,
SESS-04, TYPE-02 **Plans**: 2 plans

Plans:

- [x] 01-01-PLAN.md - Add Session type and API client methods
- [x] 01-02-PLAN.md - Integrate session resolution into follow-up command

**Success Criteria:**

1. User can run `vk attempt follow-up` and message reaches the agent
2. Follow-up automatically resolves the correct session for a workspace
3. Follow-up request includes required fields (prompt, executor_profile_id)
4. Session type exists in types.ts with correct fields

### Phase 2: Schema & Type Alignment

**Goal**: All CLI types match current vibe-kanban API schema, multi-repo
commands work **Depends on**: Phase 1 **Requirements**: SCHM-01, SCHM-02,
SCHM-03, TYPE-01, TYPE-03, TYPE-04, TYPE-05, TYPE-06, TYPE-07 **Plans**: 1 plan
(direct execution)

Plans:

- [x] 02-01: Direct type and command fixes

**Success Criteria:**

1. User can run `vk attempt branch-status` and see status for each repo
2. User can run `vk attempt pr-comments` with repo_id parameter
3. User can specify `--repo` flag on multi-repo commands
4. WorkspaceRepo uses `target_branch` field (not `branch`)
5. CreateWorkspace uses `repos[]` array (not `base_branch`)
6. Repo type includes `default_working_dir` field
7. GitBranch type includes `last_commit_date` field
8. Task type no longer has deprecated `shared_task_id` field
9. ExecutionProcess and ExecutionProcessStatus types exist

### Phase 3: Session Commands

**Goal**: Users can view and manage sessions directly **Depends on**: Phase 2
**Requirements**: SESS-05, SESS-06, SESS-07 **Plans**: 1 plan (direct execution)

Plans:

- [x] 03-01: Direct implementation of session commands

**Success Criteria:**

1. User can run `vk session list` to see all sessions for a workspace
2. User can run `vk session show` to view session details
3. User can specify `--session` flag on `attempt follow-up` to target specific
   session

### Phase 4: CLI Client Integration Tests

**Goal**: Automated tests prevent API schema mismatches from shipping **Depends
on**: Phase 2 (tests verify the fixed types) **Requirements**: TEST-01, TEST-02,
TEST-03, TEST-04 **Plans**: 1 plan (direct execution)

Plans:

- [x] 04-01: cli_client_integration_test.ts

**Success Criteria:**

1. Integration tests exist for CLI client methods (createWorkspace, followUp,
   etc.)
2. Tests verify `createWorkspace` sends `repos[]` array (not deprecated
   `base_branch`)
3. Tests verify `followUp` uses session-based endpoint with correct payload
4. Tests verify multi-repo commands handle array responses correctly
5. Tests run against live API (like existing `api_integration_test.ts`)

---

## Milestone Summary

**Key Decisions:**

- Use prompt field (not message) in FollowUpRequest to match API schema
- Use CLAUDE_CODE as default executor for follow-up when --executor not
  specified
- Single session auto-selects, multiple sessions trigger fzf
- Keep --message flag for backward compatibility, map to prompt field internally

**Issues Resolved:**

- Fixed `vk attempt follow-up` which was calling wrong endpoint
- Fixed `vk task create --run` which was missing repos[] field
- Fixed all type definitions to match current API schema

**Technical Debt Incurred:**

- None significant

---

_Archived: 2026-01-31 as part of v1.0 milestone completion_
